webpackJsonp([4],{"+Oo5":function(t,e){},K06v:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("t5DY"),s={name:"orderList",data:function(){return{dialogVisible:!1,select:{mealDate:"",mealTime:"",schoolId:0},mealTimeArr:{BREAKFAST:"早餐",LUNCH:"午餐",DINNER:"晚餐"},defaultMenuActive:"",defaultMenuOpeneds:[],detailSelect:"grade",schoolSelect:"",dateSelect:"",mealTimeSelect:"",dateData:[],gradeData:[],classData:[],listData:[],listAllData:[],listGradeData:[],listClassData:[],listOrderData:[],menuData:[]}},methods:{formatAmount:function(t){var e=(100*t/100).toFixed(2)+"";return e.substring(0,e.indexOf(".")).replace(/\B(?=(?:\d{3})+$)/g,",")+e.substring(e.length,e.indexOf("."))},formatNumber:function(t){return t.replace(/\B(?=(?:\d{3})+$)/g,",")},changeDate:function(t){this.dateSelect=t,this.getAssignMenu()},changeMenu:function(t){this.getAssignMealTimeList(t)},changeMenuItem:function(t,e){this.select.mealTime=t,this.select.schoolId=e,this.getAssignGradeList()},handleTabClick:function(t,e){var a=t.name;console.log(a),"grade"==a?this.getAssignGradeList():"class"==a?this.getAssignClassList():"order"==a&&this.getAssignOrderList()},clearSelect:function(){this.select={mealDate:"",mealTime:"",schoolId:0}},clearList:function(){this.select={mealDate:"",mealTime:"",schoolId:0}},getAssignMenu:function(){var t=this;this.menuData=[],this.mealTimeSelect="",this.listAllData=[],this.listGradeData=[];var e={mealDate:this.dateSelect};o.c.getAssignMenu(e).then(function(e){var a=[];e.data&&e.data.list.forEach(function(e,o){var s=[];e.foodList.forEach(function(t,e){s.push({schoolId:t.schoolId,schoolName:t.schoolName,foodAmount:t.foodAmount})}),a.push({name:t.mealTimeArr[e.mealTime],mealTime:e.mealTime,schoolList:s})}),t.menuData=a,t.defaultMenuActive="",t.defaultMenuOpeneds=[],t.getAssignAllList()})},getAssignAllList:function(){var t=this,e={mealDate:this.dateSelect};o.c.getAssignAllList(e).then(function(e){var a=[];e.data&&e.data.list.forEach(function(e,o){var s=1,l=[];e.foodList.forEach(function(t,e){l.push({rowId:s,foodName:t.foodName,foodAmount:t.foodAmount}),s++}),a.push({name:t.mealTimeArr[e.mealTime],foodAmount:e.foodAmount,foodList:l})}),t.listAllData=a})},getAssignMealTimeList:function(t){var e=this,a={mealDate:this.dateSelect,mealTime:t};o.c.getAssignMealTimeList(a).then(function(t){var a=[];t.data&&t.data.list.forEach(function(t,o){var s=1,l=[];t.foodList.forEach(function(t,e){l.push({rowId:s,foodName:t.foodName,foodAmount:t.foodAmount}),s++}),a.push({name:e.mealTimeArr[t.mealTime],foodAmount:t.foodAmount,foodList:l})}),e.listAllData=a})},getAssignGradeList:function(){var t=this;this.listAllData=[],this.listGradeData=[];var e={mealDate:this.dateSelect,mealTime:this.select.mealTime,schoolId:this.select.schoolId};o.c.getAssignGradeList(e).then(function(e){var a=[];e.data&&e.data.list.forEach(function(t,e){var o=1,s=[];t.foodList.forEach(function(t,e){s.push({rowId:o,foodName:t.foodName,foodAmount:t.foodAmount}),o++}),a.push({name:t.gradeName,foodAmount:t.foodAmount,foodList:s})}),t.listGradeData=a})},getAssignClassList:function(){var t=this;this.listAllData=[],this.listClassData=[];var e={mealDate:this.dateSelect,mealTime:this.select.mealTime,schoolId:this.select.schoolId};o.c.getAssignClassList(e).then(function(e){var a=[];e.data&&e.data.list.forEach(function(t,e){var o=1,s=[];t.foodList.forEach(function(t,e){var a=[];t.foodList.forEach(function(t,e){a.push({foodName:t.foodName,foodAmount:t.foodAmount})}),s.push({rowId:o,className:t.className,foodAmount:t.foodAmount,foodList:a}),o++}),a.push({name:t.gradeName,foodAmount:t.foodAmount,foodId:t.foodId.split(","),foodName:t.foodName.split(","),classList:s})}),t.listClassData=a})},getAssignOrderList:function(){var t=this;this.listAllData=[],this.listOrderData=[];var e={mealDate:this.dateSelect,mealTime:this.select.mealTime,schoolId:this.select.schoolId};o.c.getAssignOrderList(e).then(function(e){var a=[],o=1;e.data&&e.data.list.forEach(function(t,e){a.push({rowId:o,foodName:t.foodName,dinerName:t.dinerName,schoolName:t.schoolName,gradeName:t.gradeName,className:t.className}),o++}),t.listOrderData=a})},getAssignDate:function(){var t=this;o.c.getAssignDate().then(function(e){if(e.data){var a=[];e.data.list.forEach(function(e,o){0==o&&(t.dateSelect=e.date,t.getAssignMenu()),a.push({date:e.date,weekday:e.weekday})}),t.dateData=a}})},exportForm:function(){o.c.getOrderExport({}).then(function(t){t.data})}},mounted:function(){this.getAssignDate()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"orderList"},[a("div",{staticClass:"wrapper"},[a("div",{staticClass:"queryList"},[a("el-form",{staticClass:"form-inline",attrs:{inline:!0}},[a("el-row",t._l(t.dateData,function(e,o){return a("el-col",{key:o,attrs:{span:3}},[a("el-form-item",[a("el-button",{attrs:{size:"small",type:t.dateSelect==e.date?"primary":"default"},on:{click:function(a){return t.changeDate(e.date)}}},[t._v("\n                "+t._s(e.date)+"("+t._s(e.weekday)+")")])],1)],1)}),1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-menu",{attrs:{"default-active":t.defaultMenuActive,"default-openeds":t.defaultMenuOpeneds,"unique-opened":!0},on:{open:t.changeMenu}},t._l(t.menuData,function(e,o){return a("el-submenu",{key:o,attrs:{index:e.mealTime}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-burger"}),t._v(" "),a("span",[t._v(t._s(e.name))])]),t._v(" "),a("el-menu-item-group",t._l(e.schoolList,function(s,l){return a("el-menu-item",{key:l,attrs:{index:o+"-"+l},on:{click:function(a){return t.changeMenuItem(e.mealTime,s.schoolId)}}},[t._v("\n                "+t._s(s.schoolName)+"("+t._s(s.foodAmount)+"份)")])}),1)],2)}),1)],1),t._v(" "),a("el-col",{attrs:{span:18}},[t.listAllData?a("div",{staticClass:"tableCom",staticStyle:{"margin-top":"15px"}},t._l(t.listAllData,function(e,o){return a("el-row",{key:o},[a("el-row",[t._v("\n              "+t._s(e.name)+" 合计："+t._s(e.foodAmount)+"份\n            ")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.foodList,"highlight-current-row":"",border:""}},[a("el-table-column",{attrs:{prop:"rowId",label:"序号",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"foodName",label:"菜品"}}),t._v(" "),a("el-table-column",{attrs:{prop:"foodAmount",label:"份数"}})],1)],1)}),1):t._e(),t._v(" "),Object.keys(t.listGradeData).length>0?a("div",{staticClass:"tableCom",staticStyle:{"margin-top":"15px"}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleTabClick},model:{value:t.detailSelect,callback:function(e){t.detailSelect=e},expression:"detailSelect"}},[a("el-tab-pane",{attrs:{label:"部门总览",name:"grade"}},t._l(t.listGradeData,function(e,o){return a("el-row",{key:o},[a("el-row",[t._v("\n                  "+t._s(e.name)+" 合计："+t._s(e.foodAmount)+"份\n                ")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.foodList,"highlight-current-row":"",border:""}},[a("el-table-column",{attrs:{prop:"rowId",label:"序号",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"foodName",label:"菜品"}}),t._v(" "),a("el-table-column",{attrs:{prop:"foodAmount",label:"份数"}})],1)],1)}),1),t._v(" "),a("el-tab-pane",{attrs:{label:"订单明细",name:"order"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listOrderData,"highlight-current-row":"",border:""}},[a("el-table-column",{attrs:{prop:"rowId",label:"序号",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"foodName",label:"菜品"}}),t._v(" "),a("el-table-column",{attrs:{prop:"dinerName",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"gradeName",label:"部门"}})],1)],1)],1)],1):t._e()])],1)],1)])},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(t){a("+Oo5")},null,null);e.default=i.exports}});
//# sourceMappingURL=4.b34bbf531995beb23f96.js.map