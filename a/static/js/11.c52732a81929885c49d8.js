webpackJsonp([11],{IUd7:function(e,t){},"R9+M":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("t5DY"),r={name:"userList",data:function(){var e=this;return{isAdd:!1,formTitle:"",form:{id:0,statementBy:"diner",money:"",repeatPassword:"",roleId:"",fullName:"",mobilePhone:"",status:1},formInline:{dateVals:[],statementBy:"diner",schoolId:"",gradeId:"",classId:""},tableType:"school",statementByArr:{school:"按总览",diner:"按用餐人员"},schoolData:[],gradeData:[],classData:[],listData:[],pageIndex:1,pageSize:15,pageTotal:0,rules:{userName:[{required:!0,message:"请输入用户名",trigger:["blur","change"]},{required:!0,pattern:/^[0-9a-z_]+$/,message:"用户名只能包含小写字母、数字和下划线",trigger:["blur","change"]},{required:!0,min:6,max:16,message:"用户名不能小于6或大于16个字符",trigger:["blur","change"]}],newPasswordAdd:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{required:!0,min:6,message:"密码不能小于6个字符",trigger:["blur","change"]}],newPasswordUpdate:[{required:!1,min:6,message:"密码不能小于6个字符",trigger:["blur","change"]}],repeatPassword:[{required:!1,trigger:["blur","change"],validator:function(t,a,n){e.form.repeatPassword!=e.form.newPassword&&n(new Error("两次密码不一致")),n()}}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}]}}},methods:{getStatementList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,r={dateRange:null==this.formInline.dateVals?[]:this.formInline.dateVals,statementBy:this.formInline.statementBy,gradeId:Number(this.formInline.gradeId),pageIndex:t,pageSize:a};n.a.getStatementList(r).then(function(n){var r=[],i=0,s=(t-1)*a+1;n.data&&(n.data.list.forEach(function(e,t){r.push({rowId:s,id:e.id,gradeName:e.gradeName,dinerName:e.dinerName,incomeAmount:e.incomeAmount,incomeCount:e.incomeCount,refundAmount:e.refundAmount,refundCount:e.refundCount,dinerCount:e.dinerCount,finishAmount:e.finishAmount,finishCount:e.finishCount,cancelAmount:e.cancelAmount,cancelCount:e.cancelCount}),s++}),i=n.data.total),console.log(r),e.listData=r,e.pageTotal=i,e.tableType=e.formInline.statementBy})},getWithdrawInfo:function(e){var t=this;n.a.getWithdrawInfo(e).then(function(e){if(e.data){var a=e.data,n={id:a.id,userName:a.userName,roleId:a.roleId,fullName:a.fullName,mobilePhone:a.mobilePhone,createTime:a.createTime,status:a.status};t.form=n}})},updateWithdrawInfo:function(){var e=this,t={id:this.form.id,newPassword:this.form.newPassword,repeatPassword:this.form.repeatPassword,fullName:this.form.fullName,mobilePhone:this.form.mobilePhone,status:this.form.status};n.a.updateWithdrawInfo(t).then(function(t){t.data&&(0==t.data.err?(e.$message({type:"success",message:"保存成功!"}),e.dialogVisible=!1,e.getStatementList()):e.$message({type:"error",message:"保存失败!"}))})},getGradeSelect:function(){var e=this,t={schoolId:Number(this.formInline.schoolId)};n.d.getGradeSelect(t).then(function(t){if(t.data){var a=[];t.data.list.forEach(function(e,t){a.push({id:e.id,name:e.gradeName})}),e.formInline.gradeId="",e.gradeData=a,e.formInline.classId="",e.classData=[]}})},clearForm:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.form={id:0,userName:"",newPassword:"",repeatPassword:"",roleId:"",fullName:"",mobilePhone:"",status:1}},submitForm:function(){this.getStatementList()},goToDetail:function(e){this.formTitle="编辑系统用户",this.isAdd=!1,this.dialogVisible=!0,this.clearForm(),this.getWithdrawInfo(e)},submitAddForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.updateWithdrawInfo()})},cancelForm:function(){this.dialogVisible=!1},handleSizeChange:function(e){this.pageSize=e,this.getStatementList(this.pageIndex,e)},handleCurrentChange:function(e){this.pageIndex=e,this.getStatementList(e,this.pageSize)},handleSchoolChange:function(e){this.getGradeSelect()},handleGradeChange:function(e){this.getClassSelect()},changeDate:function(){this.formInline.dateVals||(this.formInline.dateVals=[],console.log(this.formInline.dateVals))}},mounted:function(){this.getGradeSelect(),this.getStatementList()}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userList"},[a("div",{staticClass:"wrapper"},[a("div",{staticClass:"queryList"},[a("el-form",{staticClass:"form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{prop:"dateVals"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange",size:"small","range-separator":"至","start-placeholder":"用餐开始日期","end-placeholder":"用餐结束日期",align:"right"},on:{change:e.changeDate},model:{value:e.formInline.dateVals,callback:function(t){e.$set(e.formInline,"dateVals",t)},expression:"formInline.dateVals"}})],1),e._v(" "),"diner"==e.formInline.statementBy?a("el-form-item",{staticStyle:{width:"150px"},attrs:{prop:"gradeId"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择部门",size:"small"},model:{value:e.formInline.gradeId,callback:function(t){e.$set(e.formInline,"gradeId","string"==typeof t?t.trim():t)},expression:"formInline.gradeId"}},e._l(e.gradeData,function(t,n){return a("el-option",{key:e._uid+"_"+n,attrs:{"element-loading-spinner":"el-icon-loading",label:t.name,value:t.id}})}),1)],1):e._e()],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("formInline")}}},[e._v("查询")])],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"tableCom",staticStyle:{"margin-top":"15px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.listData,border:""}},[a("el-table-column",{attrs:{prop:"rowId",label:"序号",width:"50"}}),e._v(" "),"diner"==e.tableType?a("el-table-column",{attrs:{prop:"dinerName",label:"人员姓名"}}):e._e(),e._v(" "),"diner"==e.tableType?a("el-table-column",{attrs:{prop:"gradeName",label:"部门"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"incomeAmount",label:"充值金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"refundAmount",label:"消费金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"finishAmount",label:"完成订单金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"finishCount",label:"完成订单份数"}})],1)],1),e._v(" "),a("div",{staticClass:"pagination",staticStyle:{"margin-top":"15px"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,45,60],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])},staticRenderFns:[]};var s=a("VU/8")(r,i,!1,function(e){a("IUd7")},null,null);t.default=s.exports}});
//# sourceMappingURL=11.c52732a81929885c49d8.js.map